<!DOCTYPE HTML>
<html lang="en" class="light sidebar-visible" dir="ltr">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title>Notegraf Documentation</title>
        <meta name="robots" content="noindex">


        <!-- Custom HTML head -->

        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff">

        <link rel="icon" href="favicon.svg">
        <link rel="shortcut icon" href="favicon.png">
        <link rel="stylesheet" href="css/variables.css">
        <link rel="stylesheet" href="css/general.css">
        <link rel="stylesheet" href="css/chrome.css">
        <link rel="stylesheet" href="css/print.css" media="print">

        <!-- Fonts -->
        <link rel="stylesheet" href="FontAwesome/css/font-awesome.css">
        <link rel="stylesheet" href="fonts/fonts.css">

        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" href="highlight.css">
        <link rel="stylesheet" href="tomorrow-night.css">
        <link rel="stylesheet" href="ayu-highlight.css">

        <!-- Custom theme stylesheets -->


        <!-- Provide site root to javascript -->
        <script>
            var path_to_root = "";
            var default_theme = window.matchMedia("(prefers-color-scheme: dark)").matches ? "navy" : "light";
        </script>
        <!-- Start loading toc.js asap -->
        <script src="toc.js"></script>
    </head>
    <body>
    <div id="body-container">
        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script>
            try {
                var theme = localStorage.getItem('mdbook-theme');
                var sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script>
            var theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { }
            if (theme === null || theme === undefined) { theme = default_theme; }
            const html = document.documentElement;
            html.classList.remove('light')
            html.classList.add(theme);
            html.classList.add("js");
        </script>

        <input type="checkbox" id="sidebar-toggle-anchor" class="hidden">

        <!-- Hide / unhide sidebar before it is displayed -->
        <script>
            var sidebar = null;
            var sidebar_toggle = document.getElementById("sidebar-toggle-anchor");
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            } else {
                sidebar = 'hidden';
            }
            sidebar_toggle.checked = sidebar === 'visible';
            html.classList.remove('sidebar-visible');
            html.classList.add("sidebar-" + sidebar);
        </script>

        <nav id="sidebar" class="sidebar" aria-label="Table of contents">
            <!-- populated by js -->
            <mdbook-sidebar-scrollbox class="sidebar-scrollbox"></mdbook-sidebar-scrollbox>
            <noscript>
                <iframe class="sidebar-iframe-outer" src="toc.html"></iframe>
            </noscript>
            <div id="sidebar-resize-handle" class="sidebar-resize-handle">
                <div class="sidebar-resize-indicator"></div>
            </div>
        </nav>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page">
                <div id="menu-bar-hover-placeholder"></div>
                <div id="menu-bar" class="menu-bar sticky">
                    <div class="left-buttons">
                        <label id="sidebar-toggle" class="icon-button" for="sidebar-toggle-anchor" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="sidebar">
                            <i class="fa fa-bars"></i>
                        </label>
                        <button id="theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="theme-list">
                            <i class="fa fa-paint-brush"></i>
                        </button>
                        <ul id="theme-list" class="theme-popup" aria-label="Themes" role="menu">
                            <li role="none"><button role="menuitem" class="theme" id="light">Light</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="rust">Rust</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="coal">Coal</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="navy">Navy</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="ayu">Ayu</button></li>
                        </ul>
                        <button id="search-toggle" class="icon-button" type="button" title="Search. (Shortkey: s)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="S" aria-controls="searchbar">
                            <i class="fa fa-search"></i>
                        </button>
                    </div>

                    <h1 class="menu-title">Notegraf Documentation</h1>

                    <div class="right-buttons">
                        <a href="print.html" title="Print this book" aria-label="Print this book">
                            <i id="print-button" class="fa fa-print"></i>
                        </a>

                    </div>
                </div>

                <div id="search-wrapper" class="hidden">
                    <form id="searchbar-outer" class="searchbar-outer">
                        <input type="search" id="searchbar" name="searchbar" placeholder="Search this book ..." aria-controls="searchresults-outer" aria-describedby="searchresults-header">
                    </form>
                    <div id="searchresults-outer" class="searchresults-outer hidden">
                        <div id="searchresults-header" class="searchresults-header"></div>
                        <ul id="searchresults">
                        </ul>
                    </div>
                </div>

                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script>
                    document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="content" class="content">
                    <main>
                        <h1 id="docker-compose-recommended"><a class="header" href="#docker-compose-recommended">Docker Compose (recommended)</a></h1>
<p>First, create a folder <code>notegraf</code>.
Then, within that folder, create a <code>docker-compose.yml</code> file.</p>
<pre><code class="language-console">notegraf
└── notegraf_config.yml
</code></pre>
<pre><code class="language-yaml"># docker-compose.yml
version: '3'
services:
  db:
    image: postgres:14
    restart: always
    environment:
      POSTGRES_USER: postgres
      POSTGRES_PASSWORD: password
      POSTGRES_DB: notegraf
      LANG: C.UTF-8
    volumes:
      - dbdata:/var/lib/postgresql/data
  notegraf:
    image: ghcr.io/caizixian/notegraf:master
    restart: always
    depends_on:
      - "db"
    ports:
      - "8000:8000"
    environment:
      NOTEGRAF_HOST: "0.0.0.0"
      NOTEGRAF_PORT: 8000
      NOTEGRAF_NOTESTORETYPE: "PostgreSQL"
      NOTEGRAF_DATABASE_HOST: "db"
      NOTEGRAF_DATABASE_PORT: 5432
      NOTEGRAF_DATABASE_USERNAME: postgres
      NOTEGRAF_DATABASE_PASSWORD: password
      NOTEGRAF_DATABASE_NAME: notegraf
      NOTEGRAF_DEBUG: false
volumes:
  dbdata:
</code></pre>
<p>Within the folder, run <code>docker-compose up -d</code>.
Your Notegraf instance should be up and running.
Open <a href="http://localhost:8000">http://localhost:8000</a> in your browser and see for yourself.</p>
<p>To update Notegraf, run <code>docker pull ghcr.io/caizixian/notegraf:master</code> and run <code>docker-compose up -d</code> again.</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="inline-math"><a class="header" href="#inline-math">Inline math</a></h1>
<p><code>`${a^2 + b^2 = c^2}$`</code></p>
<h1 id="display-mode-math"><a class="header" href="#display-mode-math">Display mode math:</a></h1>
<pre><code>```math
a^2 + b^2 = c^2
```</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="developer-guide"><a class="header" href="#developer-guide">Developer Guide</a></h1>
<h2 id="prerequisite"><a class="header" href="#prerequisite">Prerequisite</a></h2>
<ul>
<li>Rust toolchain installed via <a href="https://rustup.rs/">https://rustup.rs/</a>. Tested with 1.62.0.</li>
<li>Node.js. Tested with 16.x LTS and 18.x.</li>
<li>PostgreSQL. Tested with 14. On macOS with Homebrew installed, simply <code>brew install postgresql</code>, and follow the
instructions in the installation caveats.</li>
</ul>
<h2 id="build-from-source"><a class="header" href="#build-from-source">Build from Source</a></h2>
<pre><code class="language-bash">git clone https://github.com/caizixian/notegraf.git
cd notegraf/notegraf-web
npm install
cargo build
</code></pre>
<h2 id="setup-development-server"><a class="header" href="#setup-development-server">Setup Development Server</a></h2>
<p>First, you need to create a database, e.g., via <code>createdb notegraf</code>.</p>
<p>Then, under <code>notegraf/notegraf-web</code>, create the following two files.</p>
<pre><code class="language-console">notegraf
├── ...
└── notegraf-web
    ├── ...
    ├── .proxyrc.js
    └── configuration.yml
</code></pre>
<pre><code class="language-javascript">// .proxyrc.js
const {createProxyMiddleware} = require("http-proxy-middleware");

module.exports = function (app) {
    app.use(
        createProxyMiddleware({
            // localhost on macOS can also resolve to ::1
            // python3 -c 'import socket; print(socket.getaddrinfo("localhost", 8000))'
            // https://stackoverflow.com/questions/15227154/inexplicable-node-js-http-throwing-connect-econnrefused-ipv6
            target: "http://localhost:8000/",
            pathFilter: ["/**", "!/", "!**/*.html", "!**/*.js", "!*.css", "!**/*.css", "!**/*.map", "!**/*.ttf", "!**/*.woff", "!**/*.woff2", "!**/*.svg", "!**/*.png"],
        })
    );
};
</code></pre>
<pre><code class="language-yaml"># configuration.yml
port: 8000
notestoretype: "PostgreSQL"
debug: true
database:
  host: localhost
  port: 5432
  name: notegraf
</code></pre>
<p>Finally, open two terminal windows.
In the first window, run <code>cargo run</code> under <code>notegraf/notegraf-web</code>, and in the other window, run <code>npm start</code>.
Your browser should automatically navigate to <a href="http://localhost:1234">http://localhost:1234</a>.</p>
<h2 id="project-structure"><a class="header" href="#project-structure">Project Structure</a></h2>
<p>The repo is set up as a cargo workspace with two crates.</p>
<pre><code class="language-console">notegraf
├── ...
├── notegraf     &lt;- Notegraf core data types and persistence logics
└── notegraf-web &lt;- Notegraf HTTP frontend and web UI
</code></pre>
<h2 id="pre-commit"><a class="header" href="#pre-commit">Pre-commit</a></h2>
<p><code>cargo check &amp;&amp; cargo test &amp;&amp; cargo clippy &amp;&amp; cargo fmt</code>.</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="search-syntax"><a class="header" href="#search-syntax">Search Syntax</a></h1>
<p>A search query contains zero or more search terms, separated by spaces.</p>
<p>If any positive lexeme term is specified, results are ordered by relevance for the PostgreSQL backend.
If no positive lexeme term is specified, results are ordered by their creation time (newer notes come first) regardless
the backend.
In any other case, the order is unspecified.</p>
<p>If no positive lexeme term is specified, results are limited to 10 notes by default, unless a <code>!limit=&lt;integer&gt;</code>
modifier is used.</p>
<h2 id="lexeme-terms"><a class="header" href="#lexeme-terms">Lexeme Terms</a></h2>
<ul>
<li>Positive lexeme term: a plain word, such as <code>token</code>, will be searched against the title and the note body.</li>
<li>Negative lexeme term: prefix a word with <code>-</code> to exclude the word, such as <code>-exclude</code>.</li>
</ul>
<h2 id="tag-terms"><a class="header" href="#tag-terms">Tag Terms</a></h2>
<ul>
<li>Positive tag term: a hashtag, such as <code>#token</code>.</li>
<li>Negative tag term: prefix a hashtag with <code>-</code> to exclude the tag, such as <code>-#exclude</code>.</li>
</ul>
<h2 id="modifier-terms"><a class="header" href="#modifier-terms">Modifier Terms</a></h2>
<ul>
<li><code>!notag</code>: match notes with no tags.</li>
<li><code>!orphan</code>: match notes that have no previous note, no parent note (i.e., not a branch of another note), and not
referenced by other notes.</li>
<li><code>!limit=&lt;integer&gt;</code>: control the number of notes returned in the result to be <code>&lt;integer&gt;</code>.</li>
<li><code>!nolimit</code>: return all notes that match. This takes precedence over <code>!limit=&lt;integer&gt;</code>.</li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h1 id="changelog"><a class="header" href="#changelog">Changelog</a></h1>
<h2 id="unreleased"><a class="header" href="#unreleased">Unreleased</a></h2>
<h3 id="added"><a class="header" href="#added">Added</a></h3>
<ul>
<li>[Web UI] Better typographic punctuations.</li>
</ul>
<h3 id="changed"><a class="header" href="#changed">Changed</a></h3>
<ul>
<li>[Web UI] Set the page height to be the viewport height to allow two panes in the note search result/revision view to be scrolled independently.</li>
</ul>
<h3 id="deprecated"><a class="header" href="#deprecated">Deprecated</a></h3>
<h3 id="removed"><a class="header" href="#removed">Removed</a></h3>
<h3 id="fixed"><a class="header" href="#fixed">Fixed</a></h3>
<ul>
<li>[Web UI] Replace all occurrences of <code>&lt;URL origin&gt;/note/</code> in the note body (see v0.1.1 release) instead of just the first one.</li>
<li>[Core] Fix that deleting a note in a sequence might result in inconsistent parent/children or previous/next relationship.</li>
</ul>
<h3 id="security"><a class="header" href="#security">Security</a></h3>
<h2 id="v011-2022-09-12"><a class="header" href="#v011-2022-09-12"><a href="https://github.com/caizixian/notegraf/releases/tag/v0.1.1">v0.1.1 (2022-09-12)</a></a></h2>
<h3 id="changed-1"><a class="header" href="#changed-1">Changed</a></h3>
<ul>
<li>[Web UI] "Hyperlinks" in the note title and the backlinks/branches are now real hyperlinks, rather than clickable texts. (<a href="https://github.com/caizixian/notegraf/pull/206">#206</a>)</li>
<li>[Web UI] Any occurrence of <code>&lt;URL origin&gt;/note/</code> in the note body will be treated as cross-links, and therefore be replaced by <code>notegraf:/note/</code>. (<a href="https://github.com/caizixian/notegraf/pull/206">#206</a>)</li>
</ul>
<h3 id="fixed-1"><a class="header" href="#fixed-1">Fixed</a></h3>
<ul>
<li>[Web UI] When showing note titles for branches or backlinks, the <em>(transitive)</em> suffix (indicating that the title shown is actually the title of the closest ancestor) will be placed on the same line as the title. (<a href="https://github.com/caizixian/notegraf/pull/206">#206</a>)</li>
<li>[Web UI] When a new editing session (editing an existing note, creating a new note, etc.) is created without user interaction, the current page is <strong>replaced by</strong>, instead of being navigated away from, the editor UI. This is so that when a user navigate back to the previous page, it expectedly shows the original page where the user clicked a button. (<a href="https://github.com/caizixian/notegraf/pull/206">#206</a>)</li>
<li>[Web UI] When creating a task with a link (such as <code>- [x] [link](https://example.com)</code>) in Markdown lists, the checkbox is now aligned properly with the link. (<a href="https://github.com/caizixian/notegraf/pull/227">#227</a>)</li>
</ul>
<h2 id="v010-2022-08-30"><a class="header" href="#v010-2022-08-30"><a href="https://github.com/caizixian/notegraf/releases/tag/v0.1.0">v0.1.0 (2022-08-30)</a></a></h2>
<p>Initial release.</p>

                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->


                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">

            </nav>

        </div>




        <script>
            window.playground_copyable = true;
        </script>


        <script src="elasticlunr.min.js"></script>
        <script src="mark.min.js"></script>
        <script src="searcher.js"></script>

        <script src="clipboard.min.js"></script>
        <script src="highlight.js"></script>
        <script src="book.js"></script>

        <!-- Custom JS scripts -->

        <script>
        window.addEventListener('load', function() {
            window.setTimeout(window.print, 100);
        });
        </script>

    </div>
    </body>
</html>
